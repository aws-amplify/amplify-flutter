targets:
  $default:
    builders:
      build_web_compilers:entrypoint:
        generate_for:
          - lib/src/workers.dart
        options:
          compiler: dart2js
        dev_options:
          dart2js_args:
            - --no-minify
        release_options:
          dart2js_args:
            - -O2
      amplify_secure_storage_dart:_workers_copy:
        enabled: true

builders:
  # Copies the output of the entrypoint generator to lib/
  _workers_copy:
    import: "tool/copy_builder.dart"
    builder_factories:
      - copyBuilder
    build_extensions:
      lib/src/workers.dart.js:
        - lib/workers.js
    auto_apply: none
    build_to: source
    required_inputs: [".dart.js"]
