targets:
  $default:
    sources:
      exclude:
        - example/**
    builders:
      build_web_compilers:dart2js_archive_extractor:
        enabled: true
      build_web_compilers:entrypoint:
        enabled: false

  compile:
    auto_apply_builders: false
    builders:
      build_web_compilers:dart2js_archive_extractor:
        enabled: false
      build_web_compilers:entrypoint:
        enabled: true
        generate_for:
          - lib/src/worker/*.debug.dart
          - lib/src/worker/*.release.dart
        dev_options:
          compilers: 
            dart2js:
              args:
                - --no-minify
            dart2wasm:
              args:
                - --no-minify
        release_options:
          compilers:
            dart2js:
              args:
                - -O2
                - --define=dart.vm.product=true
            dart2wasm:
              args:
                - -O2
                - --define=dart.vm.product=true
    dependencies:
      - $default

  workers:
    auto_apply_builders: false
    builders:
      worker_bee_builder:worker_copy_builder:
        enabled: true
        generate_for:
          - lib/src/worker/*.debug.dart.js
          - lib/src/worker/*.debug.dart2js.js
          - lib/src/worker/*.debug.dart2js.js.map
          - lib/src/worker/*.release.dart.js
          - lib/src/worker/*.release.dart2js.js
          - lib/src/worker/*.release.dart2js.js.map
          - lib/src/worker/*.debug.mjs
          - lib/src/worker/*.debug.wasm
          - lib/src/worker/*.debug.wasm.map
          - lib/src/worker/*.release.mjs
          - lib/src/worker/*.release.wasm
          - lib/src/worker/*.release.wasm.map
    dependencies:
      - amplify_secure_storage_dart:compile
