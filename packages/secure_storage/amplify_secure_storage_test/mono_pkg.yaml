sdk:
  - stable
  - dev

stages:
  - analyze_and_format:
      - group:
          - format
          - analyze: --fatal-infos lib test
  - unit_test:
      - command: dart --version
      - command: tool/test-desktop.sh
        os:
          - windows
          - macos
          - linux
      # TODO(dnys1): Secure storage will not work in DDC right now due to ongoing staticInterop changes. 
      # Since the interfaces are only ever called via workers (dart2js), this is not a problem but should be monitored.
      # Issue: https://github.com/dart-lang/sdk/issues/49301
      # - command: dart run build_runner test --delete-conflicting-outputs -- -p chrome,firefox
      - command: dart run build_runner test --release --delete-conflicting-outputs -- -p chrome,firefox
